<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <script>window.AdminLTEOptions = window.AdminLTEOptions || {}; window.AdminLTEOptions.autoIframeMode = false;</script>
    {include file="common/meta" /}
    <!-- 基础库统一在 common/script 中加载 -->
    <script>
    (function() {
        try {
            if (window.self !== window.top) {
                var url = new URL(window.location.href);
                if (!url.searchParams.has('iframe') && !url.searchParams.has('addtabs')) {
                    url.searchParams.set('addtabs', '1');
                    window.location.replace(url.toString());
                }
            }
        } catch(e) {
            if (window.self !== window.top && window.location.href.indexOf('addtabs=1') === -1 && window.location.href.indexOf('iframe=1') === -1) {
                var sep = window.location.href.indexOf('?') !== -1 ? '&' : '?';
                window.location.replace(window.location.href + sep + 'addtabs=1');
            }
        }
    })();
    </script>
</head>
<body class="hold-transition sidebar-mini layout-fixed layout-navbar-fixed">
<div class="wrapper">
    <nav class="main-header navbar navbar-expand navbar-white navbar-light border-bottom">
        <ul class="navbar-nav">
            <li class="nav-item">
                <a class="nav-link" data-widget="pushmenu" href="#" role="button"><i class="fas fa-bars"></i></a>
            </li>
            <li class="nav-item d-none d-sm-inline-block">
                <a href="{:url('index/index')}" class="nav-link">首页</a>
            </li>
        </ul>
        <ul class="navbar-nav ml-auto">
            <li class="nav-item">
                <a class="nav-link" href="{:url('index/clearCache')}" data-method="ajax" title="清除缓存"><i class="fas fa-sync-alt"></i></a>
            </li>
            <li class="nav-item dropdown">
                <a class="nav-link" data-toggle="dropdown" href="#"><i class="far fa-user"></i> <span class="ml-1">{$admin.nickname|default=$admin.username}</span></a>
                <div class="dropdown-menu dropdown-menu-lg dropdown-menu-right">
                    <a href="{:url('index/logout')}" class="dropdown-item"><i class="fas fa-sign-out-alt mr-2"></i> 退出</a>
                </div>
            </li>
        </ul>
    </nav>
    <aside class="main-sidebar sidebar-dark-primary elevation-4">
        <a href="{:url('index/index')}" class="brand-link"><span class="brand-text font-weight-light">Keleadmin</span></a>
        <div class="sidebar">
            <nav class="mt-2">
                <ul class="nav nav-pills nav-sidebar flex-column nav-child-indent" data-widget="treeview" role="menu" id="menu-tree">
                    <li class="nav-item">
                        <a href="#" class="nav-link" addtabs="index" url="{:url('index/index')}" title="首页">
                            <i class="nav-icon fas fa-tachometer-alt"></i>
                            <p>首页</p>
                        </a>
                    </li>
                </ul>
            </nav>
        </div>
    </aside>
    <div class="content-wrapper">
        <div class="content-header border-bottom bg-light py-2 px-3">
            <div class="d-flex align-items-center flex-nowrap">
                <div class="dropdown mr-2">
                    <button class="btn btn-danger btn-sm dropdown-toggle" type="button" data-toggle="dropdown"><i class="fas fa-times"></i> 关闭</button>
                    <ul class="dropdown-menu">
                        <li><a class="dropdown-item" href="javascript:;" data-addtabs-close="all"><i class="fas fa-times-circle mr-2"></i> 关闭全部</a></li>
                        <li><a class="dropdown-item" href="javascript:;" data-addtabs-close="other"><i class="fas fa-times mr-2"></i> 关闭其他</a></li>
                    </ul>
                </div>
                <ul class="nav nav-addtabs flex-nowrap overflow-auto flex-grow-1 mb-0" id="nav-addtabs" role="tablist" style="min-width:0;">
                    {if isset($fixedmenu) && $fixedmenu}
                    <li role="presentation" id="tab_{$fixedmenu.id}" class="{:isset($referermenu) && $referermenu ? '' : 'active'}">
                        <a href="#con_{$fixedmenu.id}" node-id="{$fixedmenu.id}" aria-controls="{$fixedmenu.id}" role="tab" data-toggle="tab">{$fixedmenu.title|default='首页'}</a>
                        <i class="close-tab fa fa-remove"></i>
                    </li>
                    {/if}
                    {if isset($referermenu) && $referermenu}
                    <li role="presentation" id="tab_{$referermenu.id}" class="active">
                        <a href="#con_{$referermenu.id}" node-id="{$referermenu.id}" aria-controls="{$referermenu.id}" role="tab" data-toggle="tab">{$referermenu.title|default=$referermenu.id}</a>
                        <i class="close-tab fa fa-remove"></i>
                    </li>
                    {/if}
                </ul>
            </div>
        </div>
        <div class="content">
            <div class="container-fluid p-0" id="addtabs-container">
                <div class="tab-content tab-addtabs" id="tab-addtabs-content">
                    {if isset($fixedmenu) && $fixedmenu}
                    <div role="tabpanel" class="tab-pane {:isset($referermenu) && $referermenu ? '' : 'active'}" id="con_{$fixedmenu.id}">
                        <iframe name="iframe_{$fixedmenu.id}" id="iframe_{$fixedmenu.id}" src="{$fixedmenu.iframe_src}" class="addtabs-iframe" frameborder="0" style="width:100%;height:calc(100vh - 180px);min-height:400px;"></iframe>
                    </div>
                    {/if}
                    {if isset($referermenu) && $referermenu}
                    <div role="tabpanel" class="tab-pane active" id="con_{$referermenu.id}">
                        <iframe name="iframe_{$referermenu.id}" id="iframe_{$referermenu.id}" src="{$referermenu.iframe_src}" class="addtabs-iframe" frameborder="0" style="width:100%;height:calc(100vh - 180px);min-height:400px;"></iframe>
                    </div>
                    {/if}
                </div>
            </div>
        </div>
    </div>
    <footer class="main-footer">
        <strong>keleadmin</strong> thinkmes 后台
        <div class="float-right d-none d-sm-inline">Powered by <a href="https://adminlte.io/">AdminLTE 3</a></div>
    </footer>
</div>
{include file="common/script" /}
</body>
</html>
