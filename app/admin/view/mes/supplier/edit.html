<form id="form-edit" class="form-horizontal" role="form" action="" method="post">
    <div class="form-group">
        <label class="control-label col-xs-12 col-sm-2">供应商名称<span class="text-danger">*</span></label>
        <div class="col-xs-12 col-sm-8">
            <input id="c-name" class="form-control" name="row[name]" value="{$row.name|default=''}" data-rule="required" placeholder="请输入供应商名称">
        </div>
    </div>
    <div class="form-group">
        <label class="control-label col-xs-12 col-sm-2">供应商编码</label>
        <div class="col-xs-12 col-sm-8">
            <input id="c-code" class="form-control" name="row[code]" value="{$row.code|default=''}" placeholder="请输入供应商编码">
        </div>
    </div>
    <div class="form-group">
        <label class="control-label col-xs-12 col-sm-2">联系人</label>
        <div class="col-xs-12 col-sm-8">
            <input id="c-contact_person" class="form-control" name="row[contact_person]" value="{$row.contact_person|default=''}" placeholder="请输入联系人">
        </div>
    </div>
    <div class="form-group">
        <label class="control-label col-xs-12 col-sm-2">联系电话</label>
        <div class="col-xs-12 col-sm-8">
            <input id="c-contact_phone" class="form-control" name="row[contact_phone]" value="{$row.contact_phone|default=''}" placeholder="请输入联系电话">
        </div>
    </div>
    <div class="form-group">
        <label class="control-label col-xs-12 col-sm-2">地址</label>
        <div class="col-xs-12 col-sm-8">
            <input id="c-address" class="form-control" name="row[address]" value="{$row.address|default=''}" placeholder="请输入地址">
        </div>
    </div>
    <div class="form-group">
        <label class="control-label col-xs-12 col-sm-2">状态</label>
        <div class="col-xs-12 col-sm-8">
            <select id="c-status" class="form-control" name="row[status]">
                <option value="active" {$row.status|default='active'=='active'?'selected':''}>启用</option>
                <option value="inactive" {$row.status|default='active'=='inactive'?'selected':''}>禁用</option>
            </select>
        </div>
    </div>
    <div class="form-group layer-footer">
        <label class="control-label col-xs-12 col-sm-2"></label>
        <div class="col-xs-12 col-sm-8">
            <button type="submit" class="btn btn-success btn-embossed">确定</button>
            <button type="reset" class="btn btn-default btn-embossed">重置</button>
        </div>
    </div>
</form>
<script>
(function() {
    var form = $('#form-edit')[0];
    var submitBtn = $(form).find('button[type="submit"]');

    // 表单验证和提交
    $(form).on('submit', function(e) {
        e.preventDefault();

        // 验证必填项
        var name = $(form).find('[name="row[name]"]').val();
        if (!name || !name.trim()) {
            alert('请输入供应商名称');
            return false;
        }

        // 禁用按钮
        submitBtn.prop('disabled', true);

        // 提交数据
        $.ajax({
            url: $(form).attr('action') || window.location.href,
            type: 'POST',
            data: $(form).serialize(),
            dataType: 'json',
            success: function(r) {
                if (r.msg) {
                    alert(r.msg);
                }
                if (r.code === 1) {
                    window.location.href = '/admin/mes/supplier';
                }
            },
            error: function() {
                alert('网络错误，请重试');
            },
            complete: function() {
                submitBtn.prop('disabled', false);
            }
        });
    });
})();
</script>
