<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MES系统 - 租户注册</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; background: #f5f5f5; }
        .container { max-width: 600px; margin: 50px auto; padding: 20px; }
        .header { text-align: center; margin-bottom: 30px; }
        .header h1 { color: #333; font-size: 28px; margin-bottom: 10px; }
        .header p { color: #666; font-size: 14px; }
        .form-box { background: white; padding: 30px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .form-title { font-size: 20px; color: #333; margin-bottom: 20px; font-weight: bold; }
        .form-group { margin-bottom: 20px; }
        .form-group label { display: block; color: #555; margin-bottom: 8px; font-size: 14px; }
        .form-group input, .form-group select, .form-group textarea {
            width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px;
        }
        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            outline: none; border-color: #4CAF50; }
        .form-group select { background: white; }
        .btn { width: 100%; padding: 14px; background: #4CAF50; color: white; border: none; border-radius: 4px; font-size: 16px; cursor: pointer; font-weight: bold; }
        .btn:hover { background: #45a049; }
        .package-list { margin-bottom: 15px; }
        .package-item { padding: 10px; border: 1px solid #ddd; border-radius: 4px; margin-bottom: 10px; cursor: pointer; }
        .package-item:hover { background: #f9f9f9; }
        .package-item.active { border-color: #4CAF50; background: #f0f7ff; }
        .package-item h4 { margin: 0 0 10px; color: #333; }
        .package-item p { margin: 0; color: #666; font-size: 13px; }
        .hint { margin-top: 20px; padding: 15px; background: #e7f3ff; border-radius: 4px; font-size: 13px; color: #666; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>MES制造执行系统</h1>
            <p>租户注册申请</p>
        </div>

        <div class="form-box">
            <div class="form-title">租户注册</div>
            <form id="registerForm" method="post" action="/index/tenant_register/submit">

                <div class="form-group">
                    <label>* 企业名称</label>
                    <input type="text" name="company_name" required placeholder="请输入企业名称">
                </div>

                <div class="form-group">
                    <label>* 联系人</label>
                    <input type="text" name="contact_name" required placeholder="请输入联系人姓名">
                </div>

                <div class="form-group">
                    <label>* 联系电话</label>
                    <input type="tel" name="contact_phone" required placeholder="请输入联系电话">
                </div>

                <div class="form-group">
                    <label>* 联系邮箱</label>
                    <input type="email" name="contact_email" required placeholder="请输入联系邮箱">
                </div>

                <div class="form-group">
                    <label>* 期望绑定域名</label>
                    <input type="text" name="domain" required placeholder="例如: company.example.com">
                </div>

                <div class="form-group">
                    <label>* 选择套餐</label>
                    <div class="package-list">
                        <div class="package-item" onclick="selectPackage(1)">
                            <h4>基础版</h4>
                            <p>含：订单、产品、BOM、物料、工序、客户、供应商、分工、报工、工资、追溯、生产计划、工序工价</p>
                        </div>
                        <div class="package-item" onclick="selectPackage(2)">
                            <h4>标准版</h4>
                            <p>含：基础版所有功能 + 采购管理</p>
                        </div>
                        <div class="package-item" onclick="selectPackage(3)">
                            <h4>专业版</h4>
                            <p>含：标准版所有功能 + 库存管理 + 质检管理 + 发货管理 + 仓库管理</p>
                        </div>
                        <div class="package-item" onclick="selectPackage(4)">
                            <h4>企业版</h4>
                            <p>含：专业版所有功能 + BI数据报表 + 无限制用户</p>
                        </div>
                    </div>
                    <input type="hidden" name="package_id" id="packageId" value="1" required>
                </div>

                <div class="form-group">
                    <label>申请说明</label>
                    <textarea name="remark" rows="3" placeholder="请输入申请说明（选填）"></textarea>
                </div>

                <button type="submit" class="btn">提交申请</button>

                <div class="hint">
                    提交后，平台管理员会审核您的申请，审核通过后会自动创建租户并通知您。
                </div>
            </form>
        </div>
    </div>

    <script>
        function selectPackage(id) {
            document.getElementById('packageId').value = id;
            document.querySelectorAll('.package-item').forEach(item => {
                item.classList.remove('active');
            });
            event.currentTarget.classList.add('active');
        }

        document.getElementById('registerForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const formData = new FormData(this);
            fetch('/index/tenant_register/submit', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.code === 1) {
                    alert('注册成功！您的注册单号：' + data.data.register_no + '\n请等待平台管理员审核');
                    location.reload();
                } else {
                    alert('注册失败：' + (data.msg || '未知错误'));
                }
            })
            .catch(error => {
                alert('提交失败：' + error);
            });
        });
    </script>
</body>
</html>
